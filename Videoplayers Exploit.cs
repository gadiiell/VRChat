using VRC.SDK3.Components;
using VRC.SDKBase;
using VRCSDK2;

namespace Exploit.Exploits
{
    internal class VideoPlayers
    {
        internal bool OverrideVideoPlayers(string url)
        {
            string value = url.Trim();
            if (string.IsNullOrEmpty(value))
            {
                Log("Video Player", "Can't override video players (URL is null)");
                return false;
            }
            foreach (SyncVideoPlayer item in UnityEngine.Object.FindObjectsOfType<SyncVideoPlayer>())
            {
                if (item != null)
                {
                    Networking.LocalPlayer.TakeOwnership(item.gameObject);
                    VRC_SyncVideoPlayer field_Private_VRC_SyncVideoPlayer_ = item.field_Private_VRC_SyncVideoPlayer_0;
                    field_Private_VRC_SyncVideoPlayer_.Stop();
                    field_Private_VRC_SyncVideoPlayer_.Clear();
                    field_Private_VRC_SyncVideoPlayer_.AddURL(url);
                    field_Private_VRC_SyncVideoPlayer_.Next();
                    field_Private_VRC_SyncVideoPlayer_.Play();
                }
            }
            foreach (SyncVideoStream item2 in UnityEngine.Object.FindObjectsOfType<SyncVideoStream>())
            {
                if (item2 != null)
                {
                    Networking.LocalPlayer.TakeOwnership(item2.gameObject);
                    VRC_SyncVideoStream field_Private_VRC_SyncVideoStream_ = item2.field_Private_VRC_SyncVideoStream_0;
                    field_Private_VRC_SyncVideoStream_.Stop();
                    field_Private_VRC_SyncVideoStream_.Clear();
                    field_Private_VRC_SyncVideoStream_.AddURL(url);
                    field_Private_VRC_SyncVideoStream_.Next();
                    field_Private_VRC_SyncVideoStream_.Play();
                }
            }
            foreach (VRCUrlInputField item3 in UnityEngine.Object.FindObjectsOfType<VRCUrlInputField>())
            {
                if (item3 != null)
                {
                    item3.text = url;
                    item3.onEndEdit.Invoke(url);
                }
            }
            return true;
        }
    }
}
